# Zerops configuration for TapTapRace
zerops:
  - setup: dotnet
    # ==== how to build your application ====
    build:
      # what technologies should the build
      # container be based on (can be an array)
      base: dotnet@9

      # build your application
      buildCommands:
        - cd TapTapRace.Server
        - dotnet publish TapTapRace.Server.csproj -c Release -o ../app --no-restore

      # select which files / folders to deploy
      # after the build successfully finished
      # `~` can be used to mark starting point
      # of deploy path, this example would deploy
      # files in app folder without the folder
      # itself
      deployFiles: app/~

    # ==== how to run your application ====
    run:
      # what technology should the runtime
      # container be based on, can be extended
      # in `run.prepareCommands` using
      # `sudo zsc install nodejs@20`
      base: dotnet@9

      # what ports your app listens on
      # and whether it supports http traffic
      ports:
        - port: 5000
          httpSupport: true

      # how to start your application
      start: dotnet TapTapRace.Server.dll

  - setup: nodejs
    # ==== how to build your application ====
    build:
      # what technologies should the build
      # container be based on (can be an array)
      base: nodejs@20

      # build your application
      buildCommands:
        - cd taptaprace.client
        - npm ci
        - npm run build

      # select which files / folders to deploy
      # after the build successfully finished
      deployFiles:
        - dist
        - package.json
        - node_modules

    # ==== how to run your application ====
    run:
      # what technology should the runtime
      # container be based on
      base: nodejs@20

      # what ports your app listens on
      # and whether it supports http traffic
      ports:
        - port: 5173
          httpSupport: true

      # how to start your application
      start: npm run preview
